<!DOCTYPE HTML>
<html>
<head>
    <title>Junkware</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">
    <!-- <meta name="description" content="Supershape.js visualizes the 3D super formula with three.js." />
    <meta name="keywords" content="supershape, superformula, three.js, supershape.js, generative design" /> -->
    <link rel="canonical" href="http://junkware.io" />
    <link href="css/style.css" rel="stylesheet">
    
    <!-- <style type="text/css">
        #container { position: absolute;top:0px;bottom:0px;left:0px;right:0px;overflow:hidden;  }
        .info { position: absolute;top:10px;left:310px;overflow:hidden;color:white;font: 12px 'Lucida Grande', sans-serif; width:200px; line-height: 20px;}
        .info a {color: white;text-decoration: none;text-transform: uppercase;}
        .dg.a, .dg.a .close-button {width:300px !important;}
    </style>
 -->
</head>
<body>
    <div id="main">
        main
        <div id="description"></div>
        <div id="supershapes"></div>
    </div>
    <div id="sidebar">
        sidebar
        <div class="info">
        <div id="eeg"></div>
        <div id="brain-values"></div>
    </div>
    
</body>

<script type="text/javascript" src="//code.jquery.com/jquery-1.4.2.min.js"></script>
<script src="libs/d3/d3.min.js"></script>
<script src="libs/rickshaw/rickshaw.min.js"></script>

<script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/socket.io/0.9.16/socket.io.min.js"></script>

<script type="text/javascript" charset="utf-8">

    $(document).ready(function(){
        namespace = ''; // change to an empty string to use the global namespace

        var url ='http://' + document.domain + ':' + location.port + namespace;

        var socket = io.connect(url);

        socket.on('connect', function() {
            socket.emit('getdesc', {data: 'I\'m connected!'});
        });

        socket.on('description', function(data) {
            console.log(data);
            $("#description").text(data);
        });

        var seriesData;
        var palette = new Rickshaw.Color.Palette( { scheme: 'classic9' } );

        // draw bar chart
        Rickshaw.Graph.Socketio.Static = Rickshaw.Class.create( Rickshaw.Graph.Socketio, {
                request: function() {
                  var socket = io.connect(this.dataURL);
                  thisData = this;
                    socket.on('brain', function (data) {
                        // console.log(data);
                       thisData.success(data);
                    });
                }
            } );

        var EEGGraph = new Rickshaw.Graph.Socketio.Static( {
            element: document.getElementById("eeg"),
            width: 400,
            height: 200,
            renderer: 'line',
            dataURL: url,
            onData: function(d) { 
                    var seriesData=d.series;
                    var series = [
                        {
                            color: palette.color(),
                            data: seriesData[0].data,
                            name: seriesData[0].name
                        }, {
                            color: palette.color(),
                            data: seriesData[1].data,
                            name: seriesData[1].name
                        }, {
                            color: palette.color(),
                            data: seriesData[2].data,
                            name: seriesData[2].name
                        }, {
                            color: palette.color(),
                            data: seriesData[3].data,
                            name: seriesData[3].name
                        }, {
                            color: palette.color(),
                            data: seriesData[4].data,
                            name: seriesData[4].name
                        }, {
                            color: palette.color(),
                            data: seriesData[5].data,
                            name: seriesData[5].name
                        }, {
                            color: palette.color(),
                            data: seriesData[6].data,
                            name: seriesData[6].name
                        }, {
                            color: palette.color(),
                            data: seriesData[7].data,
                            name: seriesData[7].name
                        }
                    ]
                    return series;
                }
        } );
    

        var isDraw=false;
        var svg,x,y,width,height,margin;

        socket.on('brain', function(data) {
            console.log(data);
            var brainValues=[
                {
                    "name": "attention",
                    "value": data.point.attention // Math.random()*200//
                },
                {
                    "name" : "meditation",
                    "value": data.point.meditation // Math.random()*200// 
                }
            ];

            // console.log(brainValues);
            if(!isDraw){
                margin = {top: 20, right: 20, bottom: 30, left: 40};
                width = 200 - margin.left - margin.right;
                height = 300 - margin.top - margin.bottom;

                x = d3.scale.ordinal()
                    .rangeRoundBands([0, width], .1);

                y = d3.scale.linear()
                    .range([height, 0]);

                var xAxis = d3.svg.axis()
                    .scale(x)
                    .orient("bottom");

                var yAxis = d3.svg.axis()
                    .scale(y)
                    .orient("left");
                    // .ticks(10, "%");

                svg = d3.select("#brain-values").append("svg")
                    .attr("width", width + margin.left + margin.right)
                    .attr("height", height + margin.top + margin.bottom)
                  .append("g")
                    .attr("transform", "translate(" + margin.left + "," + margin.top + ")");

                x.domain(brainValues.map(function(d) { return d.name; }));
                y.domain([0, 200]);

                svg.append("g")
                  .attr("class", "x axis")
                  .attr("transform", "translate(0," + height + ")")
                  .call(xAxis);

                svg.append("g")
                  .attr("class", "y axis")
                  .call(yAxis)
                .append("text")
                  .attr("transform", "rotate(-90)")
                  .attr("y", 6)
                  .attr("dy", ".71em")
                  .style("text-anchor", "end")
                  .text("Value");
             
                svg.selectAll(".bar")
                  .data(brainValues)
                .enter().append("rect")
                  .attr("class", "bar")
                  .attr("x", function(d) { return x(d.value); })
                  .attr("width", x.rangeBand())
                  .attr("y", function(d) { return y(d.value); })
                  .attr("height", function(d) { return height - y(d.value); });

                isDraw=true;
            } else {
                 update(brainValues);
            }

            function update (_data) {
                svg.selectAll(".bar")
                  .data(_data)
                  .transition()
                  .attr("x", function(d) { return x(d.name); })
                  .attr("width", x.rangeBand())
                  .attr("y", function(d) { return y(d.value); })
                  .attr("height", function(d) { return height - y(d.value); });
            }

        });


        /*
        $('form#emit').submit(function(event) {
            socket.emit('my event', {data: $('#emit_data').val()});
            return false;
        });
        */
    });
</script>
<!-- <script src="js/realtimegraph.js"></script> -->
<!-- <script src="libs/threejs/build/three.js"></script> -->
<!-- 
<script src="lib/dat.gui.min.js"></script>  
<script src="lib/three.js/Three.js"></script>
<script src="lib/three.js/Detector.js"></script>

<script src="lib/three.js/Stats.js"></script> 
<script src="lib/threex/THREEx.WindowResize.js"></script>
<script src="lib/threex/THREEx.FullScreen.js"></script>
<script src="lib/threex/THREEx.screenshot.js"></script>


<script src="lib/three.js/ShaderExtras.js"></script>
<script src="lib/three.js/postprocessing/EffectComposer.js"></script>
<script src="lib/three.js/postprocessing/RenderPass.js"></script>
<script src="lib/three.js/postprocessing/ShaderPass.js"></script>
<script src="lib/three.js/postprocessing/MaskPass.js"></script> 


<script src="js/supershape/variables.js" type="text/javascript"></script>
<script src="js/supershape/objects.js" type="text/javascript"></script>
<script src="js/supershape/eventHandler.js" type="text/javascript"></script>
<script src="js/supershape/setup.js" type="text/javascript"></script>
<script src="js/supershape/gui.js" type="text/javascript"></script>

<script type="text/javascript">
    initApp();
</script> -->
</html>
