{% extends "layout.html" %}

{% block content %}
<div class="row jumbotron">
    <a type="button" class="create-junk btn btn-primary">Process DNA Information</a>
</div>

<div class="row">
    <div class="progress">
      <div class="progress-bar progress-bar-striped" role="progressbar" aria-valuenow="10" aria-valuemin="0" aria-valuemax="100" style="width: 0%;">
        
      </div>
    </div>
</div>

<div class="alert alert-success alert-dismissible" role="alert">
  <button type="button" class="close" data-dismiss="alert"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>

  <strong>DNA analysis succesfull!</strong> Do you want to continue to to the dashboard?
    <a type="button" class="go-junk btn btn-success">Yes</a>
    <a type="button" class="create-junk btn btn-failure">No, retry DNA Analysis</a>
</div>


</div>

<script>
    $(".progress").hide();
    $(".alert").hide();

    $(".create-junk").click(function(){
        $(".progress").show();

        $.post( "/api/junks", { data: "John", time: "2pm" }, function( data ) {
            $(".go-junk").click(function(){
                window.location.href = "/api/junk/"+data._id.$oid;
            })
            startTimer();
        });

        
    })

    
    function startTimer () {

        var progress = 0;
        var timer = setInterval(function() {
            progress+=1;
            // console.log(progress);
            $(".progress-bar").css("width",progress)
            $(".progress-bar").width(progress+"%");
            $(".progress-bar").text(progress);

            if (progress == 100 ) {
                clearInterval(timer);
                $(".alert").show();
            }

        }, 100)
    }
</script>
{% endblock %}
